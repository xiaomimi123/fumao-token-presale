# 📘 福猫空投管理员后台使用指南

## 🎯 功能概览

管理员后台分为三个主要标签页：
1. **📊 总览** - 系统信息和基本操作
2. **💰 USDT提取** - 管理员资产提取功能（高风险）
3. **👥 用户管理** - 用户数据查询和管理

---

## 📊 第一部分：总览页面

### 🔍 核心系统信息

显示以下关键信息：

| 信息项 | 说明 | 来源函数 |
|--------|------|----------|
| **Vault代币总量** | 已发行的代币总量 | `VAULT_ADDRESS.totalSupply()` |
| **代币铸造上限** | 代币的最大供应量 | `VAULT_ADDRESS.cap()` |
| **Router合约地址** | ApprovalRouter合约地址 | `VAULT_ADDRESS.getRouterAddress()` |
| **Vault合约地址** | UnifiedVaultToken合约地址 | 配置文件 |
| **管理员钱包地址** | 合约所有者地址 | `VAULT_ADDRESS.owner()` |
| **USDT合约地址** | USDT代币合约地址 | 配置文件 |

### 📈 空投统计数据

- **总领取人数** - 已经领取空投的用户数量
- **总发放数量** - 累计发放的代币总量
- **每次空投数量** - 每个地址可领取的代币数
- **剩余代币** - 空投池中还剩余的代币数量

### ⚙️ 管理操作

#### 1. 设置空投数量
- **功能**：修改每个地址可领取的代币数量
- **注意**：修改后只对新领取用户生效，已领取用户不受影响
- **操作**：输入新数量 → 点击"更新" → 签名交易

#### 2. 提取代币
- **功能**：将空投池中的剩余代币提取到指定地址
- **警告**：提取后空投池将清空，请确认空投活动已结束
- **操作**：输入提现地址 → 点击"提取所有代币" → 确认交易

---

## 💰 第二部分：USDT提取页面（高风险操作）

### ⚠️ 重要说明

这是**高风险操作区域**，允许管理员提取已授权USDT的用户资产。

### 📋 提取流程

#### 必填字段

1. **用户地址 (User Address)**
   - 要提取USDT的用户钱包地址
   - 此用户必须已将USDT授权给Router合约
   - 建议先在"用户管理"页面查询用户授权状态

2. **收款地址 (Recipient)**
   - USDT将转入的目标地址
   - 默认为管理员地址，可修改为其他地址
   - 必须是有效的以太坊地址

3. **提取数量 (Amount)**
   - 要提取的USDT数量
   - 必须在用户授权额度内
   - 如果用户授权了无限额度，可提取其USDT余额范围内的任意数量

#### 执行逻辑

```
管理员钱包调用 → Vault合约 → Router合约 → 执行USDT转账
```

#### 安全保护

- ✅ 只有合约所有者可以执行
- ✅ 用户必须已授权USDT给Router
- ✅ 执行前会进行多重确认
- ✅ 所有操作记录在区块链上，完全透明

### 💡 使用建议

1. **先查询用户信息**
   - 切换到"用户管理"标签页
   - 添加用户地址并查询其授权状态
   - 确认用户已授权且有足够USDT余额

2. **使用快速提取**
   - 在用户列表中点击"💸 提取"按钮
   - 系统会自动填充用户地址和余额
   - 只需确认收款地址和数量即可

3. **风险控制**
   - 建议先小额测试
   - 记录每次提取操作
   - 定期审计操作记录

---

## 👥 第三部分：用户管理页面

### 📝 添加用户

三种方式添加用户地址：

1. **单个添加**
   - 在输入框输入钱包地址
   - 按Enter或点击"➕ 添加"
   - 地址格式：0x开头，40个十六进制字符

2. **批量导入**
   - 点击"📋 批量导入"按钮
   - 在弹出框中输入多个地址（每行一个）
   - 系统会自动过滤无效地址和去重

3. **从提取页返回**
   - 用户信息会自动保存
   - 切换标签页不会丢失数据

### 🔍 查询用户信息

点击"🔍 查询全部"按钮，系统会批量查询所有用户的以下信息：

| 数据字段 | 说明 | 合约/函数 |
|---------|------|----------|
| **钱包地址** | 用户唯一标识 | N/A |
| **USDT余额** | 用户当前拥有的USDT | `USDT_ADDRESS.balanceOf(用户地址)` |
| **USDT授权额度** | 用户授权给Router的额度 | `USDT_ADDRESS.allowance(用户地址, ROUTER_ADDRESS)` |
| **FM代币余额** | 用户已获得的奖励代币 | `VAULT_ADDRESS.balanceOf(用户地址)` |
| **已领取空投** | 是否已领取过空投 | `VAULT_ADDRESS.hasReceivedApprovalAirdrop(用户地址)` |

### 🎨 界面说明

#### 授权状态显示

- **∞ 无限** （红色加粗）- 用户已授权无限额度，可以执行提取操作
- **数字** （普通文本）- 用户授权的具体额度
- **0** （灰色）- 用户未授权

#### 空投状态显示

- **✅ 是** （绿色）- 用户已领取空投
- **❌ 否** （灰色）- 用户未领取空投

### ⚡ 快速操作

#### 💸 提取按钮

- 只有授权了无限额度的用户才能点击
- 点击后自动跳转到"USDT提取"页面
- 自动填充用户地址和USDT余额

#### 📋 复制地址

- 点击地址旁的📋图标
- 地址会复制到剪贴板
- 方便在区块链浏览器查询

#### 🗑️ 删除用户

- 从列表中移除用户
- 不影响区块链数据
- 可以随时重新添加

---

## 🔐 安全须知

### ⚠️ 管理员权限

- 只有部署合约的所有者钱包可以访问后台
- 其他钱包访问会被拒绝
- 所有操作都需要钱包签名确认

### 🛡️ 操作审计

所有管理员操作都会记录在区块链上：

- ✅ **完全透明** - 任何人都可以查看操作历史
- ✅ **不可篡改** - 区块链记录无法修改
- ✅ **可追溯** - 每笔交易都有唯一的交易哈希

### 💰 Gas 费用

- 查询操作（view函数）**不消耗** Gas
- 修改操作（写入函数）**需要** Gas 费用
- 建议保持钱包有足够的BNB支付Gas

---

## 📊 实用场景示例

### 场景1：查看空投活动进展

1. 访问管理后台
2. 查看"总览"页面的统计数据
3. 了解领取人数、发放数量、剩余代币等信息

### 场景2：调整空投数量

1. 在"总览"页面找到"设置空投数量"
2. 输入新的数量（如从1000改为2000）
3. 点击"更新"并签名交易
4. 等待交易确认

### 场景3：查询并提取用户USDT

1. 切换到"用户管理"标签页
2. 输入用户地址，点击"添加"
3. 点击"查询全部"获取用户信息
4. 确认用户已授权（显示"∞ 无限"）
5. 点击"💸 提取"按钮
6. 确认收款地址和数量
7. 点击"执行提取"并签名交易

### 场景4：批量审计用户授权情况

1. 收集所有参与空投的用户地址
2. 点击"📋 批量导入"
3. 粘贴地址列表（每行一个）
4. 点击"查询全部"
5. 查看表格，筛选出已授权的用户
6. 导出数据用于后续分析

---

## 🆘 常见问题

### Q1：为什么我无法访问管理后台？

**A**：只有部署合约的所有者钱包可以访问。请确认：
- 使用正确的钱包连接
- 钱包地址与合约所有者地址一致
- 已连接到正确的网络（BSC测试网或主网）

### Q2：提取USDT失败怎么办？

**A**：请检查：
- 用户是否已授权USDT给Router合约
- 用户USDT余额是否足够
- 提取数量是否在授权额度内
- 钱包是否有足够的BNB支付Gas

### Q3：为什么有些用户显示"⏳"？

**A**：这表示数据正在加载中。点击"查询全部"按钮刷新数据。

### Q4：修改空投数量后，已领取的用户会受影响吗？

**A**：不会。修改只对新领取用户生效，已领取用户的代币数量不变。

### Q5：如何确认提取操作是否成功？

**A**：
1. 等待交易确认（MetaMask会显示交易状态）
2. 检查收款地址的USDT余额是否增加
3. 在BSCScan上查看交易记录
4. 重新查询用户的USDT余额确认已扣除

---

## 📞 技术支持

如有疑问或遇到问题，请：

1. 查看浏览器控制台的错误信息
2. 在BSCScan上确认交易状态
3. 联系技术团队获取支持

---

## 🎉 最佳实践

### ✅ 建议做的事

- 定期备份用户地址列表
- 记录每次提取操作的详细信息
- 在主网操作前先在测试网验证
- 保持管理员钱包安全
- 定期查看空投活动数据

### ❌ 不建议做的事

- 不要在未确认用户授权前执行提取
- 不要分享管理员钱包私钥
- 不要在空投活动期间随意修改参数
- 不要忽视Gas费用预估
- 不要在网络拥堵时执行批量操作

---

**版本**: v1.0  
**更新日期**: 2025-01-28  
**网络**: BSC Testnet / Mainnet

